# 作業一覧（チェックリスト）

このチェックリストは **作業の過程で随時追加・更新していく「生きたドキュメント」** です。
- 完了した項目はチェック済みにします。
- 新しいタスクが見つかったら、このファイルに遠慮なく追記してOKです。

---

## 環境（事前準備）
- [x] Dev Container（python 3.12）で開発できる
- [x] 依存関係インストール（requirements）
- [x] 音声デバイス共有（/dev/snd）確認

## Phase 1: 遅延計測（Stop Latency）

### ドキュメント更新（Phase 1）
- [ ] 仕様/挙動が変わったら [docs/spec/仕様書.md](../spec/%E4%BB%95%E6%A7%98%E6%9B%B8.md) の Step 1.x を更新
- [ ] 手順が変わったら [docs/howto/Phase1_遅延計測ベンチ_手順.md](../howto/Phase1_%E9%81%85%E5%BB%B6%E8%A8%88%E6%B8%AC%E3%83%99%E3%83%B3%E3%83%81_%E6%89%8B%E9%A0%86.md) を更新
- [ ] 新しいコマンド/オプションを追加したら [docs/ガイド.md](../%E3%82%AC%E3%82%A4%E3%83%89.md) の「すぐ動かす」「コマンド」節を更新
- [ ] 出力場所やファイル名を変えたら [docs/ガイド.md](../%E3%82%AC%E3%82%A4%E3%83%89.md) と [README.md](../../README.md) のリンク整合を確認

### 遅延計測ベンチ（仕様書 Step 1.0 相当）
- [x] ベンチCLI実装（マイク→特徴量→判定→停止）
- [x] p50/p95/p99/std を算出できる
- [x] stopイベントを JSONL に保存できる
- [x] デバイス一覧/デバイス指定オプション追加（入力/出力 index）
- [x] ビープ対策（デフォルト無音出力）
- [x] 実機で計測実施（入力4/出力0）
- [x] 計測結果を保存（outputs配下）

### 割り込み検知（Reflex：暫定DSP → 将来SNNへ）
- [x] 適応閾値（EMA）
- [x] 不感期（hold-off）
- [x] ループバック抑制フック（loopback_active）
- [x] ユニットテスト（Reflex/特徴量）
- [ ] Reflex Circuit をSNN版へ置換（SpikingJelly, 固定重み + 安全ロジック）
- [ ] SNN版Reflexで誤検知チューニング（咳払い/打音など）

### 停止制御（Hard Stop：TTS等を含む停止）
- [ ] VOICEVOX等の実TTS再生キューのクリア
- [ ] オーディオデバイスのリセット（APIレベルでプリエンプティブ確認）
- [ ] 停止のエンドツーエンド測定（TTSを含む）

---

## Phase 2: 短期記憶（STP / MC）

### ドキュメント更新（Phase 2）
- [ ] STP/MCの仕様や用語が変わったら [docs/spec/仕様書.md](../spec/%E4%BB%95%E6%A7%98%E6%9B%B8.md) の Step 2.x を更新
- [ ] 手順が変わったら [docs/howto/Phase2_MC探索_手順.md](../howto/Phase2_MC%E6%8E%A2%E7%B4%A2_%E6%89%8B%E9%A0%86.md) を更新
- [ ] 新しい探索コマンド/引数を追加したら [docs/ガイド.md](../%E3%82%AC%E3%82%A4%E3%83%89.md) のMC節（実行/出力/見方）を更新
- [ ] MCレポートの雛形を変えたら、既存レポートを `python -m sorch.bench.mc_report_all --overwrite` で再生成

### STPニューロン（仕様書 Step 2.1 相当）
- [x] `STP_LIFNode` 実装（Tsodyks–Markram）
- [x] ユニットテスト追加

### MC探索（仕様書 Step 2.2 相当）
- [x] 500〜1000ニューロンのリザーバ構築
- [ ] 入力パターン生成（ランダム/疑似会話テンポ）
- [x] MCスコア計測（過去入力の復元）
- [x] 探索パラメータ sweep（tau_F/tau_D/W_scale）
- [x] 結果をCSV/JSONで保存
- [x] MC探索スクリプトの手順書を整備
- [x] MCグリッド探索（複数条件を一括実行）
- [x] MC 2段階探索（粗→細、自動リファイン）
- [x] MC結果の集計（Top候補レポート生成）

## Phase 2: Readout / 次元削減（仕様書 Step 2.3 相当）
- [ ] Random Projection 実装
- [ ] Readoutが参照する状態ベクトル設計（どの信号を含めるか）

## Phase 2: オンライン学習（RLS：仕様書 Step 2.4 相当）
- [ ] 忘却係数 lambda + Tikhonov正則化
- [ ] 更新間隔（10–50ms）での安定動作

---

## Phase 3: システム統合と非同期制御
- [ ] マルチプロセス設計（Audio/Core/Cognitive）
- [ ] Lock-free Ring Buffer (SPSC) 導入
- [ ] Stop信号を物理レベルで最優先する制御

### ドキュメント更新（Phase 3）
- [ ] アーキテクチャ/IPC/優先度設計が変わったら [docs/spec/仕様書.md](../spec/%E4%BB%95%E6%A7%98%E6%9B%B8.md) の Step 3.x を更新
- [ ] 起動方法/運用フローが変わったら [docs/ガイド.md](../%E3%82%AC%E3%82%A4%E3%83%89.md) の「運用」節を更新
- [ ] ディレクトリ構成や入口を変えたら [README.md](../../README.md) と [docs/ガイド.md](../%E3%82%AC%E3%82%A4%E3%83%89.md) の導線を更新
- [ ] 新しい常駐コマンド/実行手順を追加したら [docs/ガイド.md](../%E3%82%AC%E3%82%A4%E3%83%89.md) の「実行」「コマンド」節を更新

---

## Phase 4: UX向上と常駐化

### ドキュメント更新（Phase 4）
- [ ] UX/常駐まわりの仕様が変わったら [docs/spec/仕様書.md](../spec/%E4%BB%95%E6%A7%98%E6%9B%B8.md) の Step 4.x を更新
- [ ] Brain Visualizer の使い方/見方が変わったら [docs/ガイド.md](../%E3%82%AC%E3%82%A4%E3%83%89.md) に追記
- [ ] ユーザーが触る設定が増えたら [docs/project/用語集.md](%E7%94%A8%E8%AA%9E%E9%9B%86.md) に追記
- [ ] 新しい成果物（スクショ/デモ/使い方）が増えたら [docs/project/成果サマリ.md](%E6%88%90%E6%9E%9C%E3%82%B5%E3%83%9E%E3%83%AA.md) を更新

- [ ] Brain Visualizer（デバッグ可視化）
- [ ] 会話パラメータのチューニングUI/設定管理

# 作業一覧（チェックリスト）

このチェックリストは [docs/spec/仕様書.md](../spec/%E4%BB%95%E6%A7%98%E6%9B%B8.md) のロードマップと一致させる。

---

## 再利用メモ（完了済みの基盤）

新構想でも利用できる成果（そのまま使う／最短移植できるもの）。

- [x] Hard Stop最優先フラグ: `sorch/ipc/stop_flag.py` / `tests/test_stop_flag.py`
- [x] 低次元ベクトル共有（seq付き）: `sorch/ipc/control_vec.py` / `tests/test_control_vec.py`
- [x] SPSCリング: `sorch/ipc/spsc_ring.py` / `tests/test_spsc_ring.py`
- [x] マルチプロセス縦切りデモ: `sorch/runtime/phase3_demo.py`
- [x] Phase2探索基盤（MC/RLS/レポート）: `sorch/bench/*`

---

## Phase 1: 停止の実測と安全停止の土台

### Step 1.0: Stop遅延の計測基盤（JSONL / p95/p99）
- [x] ベンチ実行手順を確認: [docs/howto/Phase1_遅延計測ベンチ_手順.md](../howto/Phase1_%E9%81%85%E5%BB%B6%E8%A8%88%E6%B8%AC%E3%83%99%E3%83%B3%E3%83%81_%E6%89%8B%E9%A0%86.md)
- [x] 計測条件（frames/sample-rate等）を記録できるようにする（`*.meta.json` を出力）

### Step 1.1: Reflex（暫定DSP→将来SNN置換）
- [x] 割り込み兆候（Soft Interrupt）を観測として定義（`Interrupt_Cue` としてログ化）
- [x] 誤検知/チャタリングの回帰観測（ログ）を整備（ベンチ出力に cue/strength を含める）

### Step 1.2: Hard Stop を“実デバイス停止”までE2E検証
- [x] publish→無音化 と publish→物理停止 を分けて計測・保存（`--stop-mode close_reopen` で close を記録）
- [x] Driverの停止セマンティクス（無音化/停止/close/キャンセル）を明文化（仕様書の Hard Stop 節）

---

## Phase 2: 短期記憶とオンライン更新

### Step 2.1: STP リザーバ
- [x] STPの採用範囲（どの領域/どの状態を観測するか）を仕様化（仕様書の Reservoir 節）

### Step 2.2: MC 探索
- [x] 実行手順を確認: [docs/howto/Phase2_MC探索_手順.md](../howto/Phase2_MC%E6%8E%A2%E7%B4%A2_%E6%89%8B%E9%A0%86.md)
- [x] 探索結果の保存方針（Git管理/非管理）を決める（`.gitignore` を正：レポートを残す）

### Step 2.3: 状態ベクトル設計と次元削減
- [x] state vector / readout の責務分担を仕様化（Core内・Driver内の境界）

### Step 2.4: RLS 等でオンライン更新
- [x] 更新間隔（10–50ms相当）での安定運用条件を仕様として固定（block update を基本）

---

## Phase 3: システム統合（単一SNN + Actuation Drivers）

### Step 3.1: Core→Driver I/O（Action Plan / Readout / Driver API）
- [ ] Action Plan の最小スキーマを確定（`text` + $u$）
- [ ] 出力チャネル割当（readout）を定義（正規化/飽和/レート制限）
- [ ] Driver→Core の最小フィードバック（Actuation State）を定義

### Step 3.2: マルチプロセス縦切り（入力→Core→Driver）
- [ ] Driverスタブ（no-op/ログ）で Action Plan 経路を通す
- [ ] E2EでHard Stopが退行しない回帰を追加

### Step 3.3: 低遅延IPC
- [ ] 通常経路（SPSC）でのイベント/特徴量/Action Planの運搬設計を確定

### Step 3.4: Soft Interrupt の学習導入
- [ ] Soft Interrupt に対する行動選択（譲る/話し切る/待つ）を評価できるログ/KPIを定義

---

## Phase 4: 運用・可視化

### Step 4.1: Brain Visualizer
- [ ] 状態/スパイク/Driver状態の可視化（最小）

### Step 4.2: 設定とチューニングの運用化
- [ ] 実験条件の保存・再現（config/seed/log）
